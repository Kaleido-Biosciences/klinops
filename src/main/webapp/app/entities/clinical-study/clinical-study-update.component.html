<!--
  ~ Copyright (c) 2019. Kaleido Biosciences. All Rights Reserved.
  -->

<div class="row justify-content-center">
    <div class="col-8">
        <form name="editForm" role="form" novalidate (ngSubmit)="save()" [formGroup]="editForm">
            <h2 id="ko-clinical-study-heading" jhiTranslate="klinopsApp.clinicalStudy.home.createOrEditLabel">Create or edit a Clinical Study</h2>
            <div>
                <ko-alert-error></ko-alert-error>
                <div class="form-group" [hidden]="!editForm.get('id').value">
                    <label for="id" jhiTranslate="global.field.id">ID</label>
                    <input type="text" class="form-control" id="id" name="id" formControlName="id"
                        readonly />
                </div>
                <div class="form-group">
                    <label class="form-control-label" jhiTranslate="klinopsApp.clinicalStudy.studyIdentifier" for="field_studyIdentifier" [ngbTooltip]="'klinopsApp.clinicalStudy.help.studyIdentifier' | translate">Study Identifier</label>
                    <input type="text" class="form-control" name="studyIdentifier" id="field_studyIdentifier"
                           formControlName="studyIdentifier"/>
                    <div *ngIf="editForm.get('studyIdentifier').invalid && (editForm.get('studyIdentifier').dirty || editForm.get('studyIdentifier').touched)">
                    </div>
                </div>
                <div class="form-group">
                    <label class="form-control-label" jhiTranslate="klinopsApp.clinicalStudy.phase" for="field_phase" [ngbTooltip]="'klinopsApp.clinicalStudy.help.phase' | translate">Phase</label>
                    <input type="text" class="form-control" name="phase" id="field_phase"
                           formControlName="phase"/>
                </div>
                <div class="form-group">
                    <label class="form-control-label" jhiTranslate="klinopsApp.clinicalStudy.status" for="field_status" [ngbTooltip]="'klinopsApp.clinicalStudy.help.status' | translate">Status</label>
                    <input type="text" class="form-control" name="status" id="field_status"
                           formControlName="status"/>
                </div>
                <div class="form-group">
                    <label class="form-control-label" jhiTranslate="klinopsApp.clinicalStudy.sequence" for="field_sequence" [ngbTooltip]="'klinopsApp.clinicalStudy.help.sequence' | translate">Sequence</label>
                    <input type="number" class="form-control" name="sequence" id="field_sequence"
                           formControlName="sequence"/>
                </div>
                <div class="form-group">
                    <label class="form-control-label" jhiTranslate="klinopsApp.clinicalStudy.studyYear" for="field_studyYear" [ngbTooltip]="'klinopsApp.clinicalStudy.help.studyYear' | translate">Study Year</label>
                    <input type="number" class="form-control" name="studyYear" id="field_studyYear"
                           formControlName="studyYear"/>
                    <div *ngIf="editForm.get('studyYear').invalid && (editForm.get('studyYear').dirty || editForm.get('studyYear').touched)">
                        <small class="form-text text-danger"
                               *ngIf="editForm.get('studyYear').errors.min" jhiTranslate="entity.validation.min" [translateValues]="{ min: 1900 }">
                            This field should be at least 1900.
                        </small>
                        <small class="form-text text-danger"
                            [hidden]="!editForm.get('studyYear')?.errors?.number" jhiTranslate="entity.validation.number">
                            This field should be a number.
                        </small>
                    </div>
                </div>
                <div class="form-group">
                    <label class="form-control-label" jhiTranslate="klinopsApp.clinicalStudy.name" for="field_name" [ngbTooltip]="'klinopsApp.clinicalStudy.help.name' | translate">Name</label>
                    <input type="text" class="form-control" name="name" id="field_name"
                           formControlName="name"/>
                    <div *ngIf="editForm.get('name').invalid && (editForm.get('name').dirty || editForm.get('name').touched)">
                        <small class="form-text text-danger"
                               *ngIf="editForm.get('name').errors.maxlength" jhiTranslate="entity.validation.maxlength" [translateValues]="{ max: 500 }">
                        This field cannot be longer than 500 characters.
                        </small>
                    </div>
                </div>
                <div class="form-group">
                    <label class="form-control-label" jhiTranslate="klinopsApp.clinicalStudy.design" for="field_design" [ngbTooltip]="'klinopsApp.clinicalStudy.help.design' | translate">Design</label>
                    <input type="text" class="form-control" name="design" id="field_design"
                           formControlName="design"/>
                </div>
                <div class="form-group">
                    <label class="form-control-label" jhiTranslate="klinopsApp.clinicalStudy.numberOfCohorts" for="field_numberOfCohorts" [ngbTooltip]="'klinopsApp.clinicalStudy.help.numberOfCohorts' | translate">Number Of Cohorts</label>
                    <input type="number" class="form-control" name="numberOfCohorts" id="field_numberOfCohorts"
                           formControlName="numberOfCohorts"/>
                    <div *ngIf="editForm.get('numberOfCohorts').invalid && (editForm.get('numberOfCohorts').dirty || editForm.get('numberOfCohorts').touched)">
                        <small class="form-text text-danger"
                               *ngIf="editForm.get('numberOfCohorts').errors.min" jhiTranslate="entity.validation.min" [translateValues]="{ min: 0 }">
                            This field should be at least 0.
                        </small>
                        <small class="form-text text-danger"
                            [hidden]="!editForm.get('numberOfCohorts')?.errors?.number" jhiTranslate="entity.validation.number">
                            This field should be a number.
                        </small>
                    </div>
                </div>
                <div class="form-group">
                    <label class="form-control-label" jhiTranslate="klinopsApp.clinicalStudy.intendedSubjectsPerCohort" for="field_intendedSubjectsPerCohort" [ngbTooltip]="'klinopsApp.clinicalStudy.help.intendedSubjectsPerCohort' | translate">Intended Subjects Per Cohort</label>
                    <input type="number" class="form-control" name="intendedSubjectsPerCohort" id="field_intendedSubjectsPerCohort"
                           formControlName="intendedSubjectsPerCohort"/>
                    <div *ngIf="editForm.get('intendedSubjectsPerCohort').invalid && (editForm.get('intendedSubjectsPerCohort').dirty || editForm.get('intendedSubjectsPerCohort').touched)">
                        <small class="form-text text-danger"
                               *ngIf="editForm.get('intendedSubjectsPerCohort').errors.min" jhiTranslate="entity.validation.min" [translateValues]="{ min: 0 }">
                            This field should be at least 0.
                        </small>
                        <small class="form-text text-danger"
                            [hidden]="!editForm.get('intendedSubjectsPerCohort')?.errors?.number" jhiTranslate="entity.validation.number">
                            This field should be a number.
                        </small>
                    </div>
                </div>
                <div class="form-group">
                    <label class="form-control-label" jhiTranslate="klinopsApp.clinicalStudy.populationDiseaseState" for="field_populationDiseaseState" [ngbTooltip]="'klinopsApp.clinicalStudy.help.populationDiseaseState' | translate">Population Disease State</label>
                    <input type="text" class="form-control" name="populationDiseaseState" id="field_populationDiseaseState"
                           formControlName="populationDiseaseState"/>
                </div>
                <div class="form-group">
                    <label class="form-control-label" jhiTranslate="klinopsApp.clinicalStudy.minimumAge" for="field_minimumAge" [ngbTooltip]="'klinopsApp.clinicalStudy.help.minimumAge' | translate">Minimum Age</label>
                    <input type="number" class="form-control" name="minimumAge" id="field_minimumAge"
                           formControlName="minimumAge"/>
                    <div *ngIf="editForm.get('minimumAge').invalid && (editForm.get('minimumAge').dirty || editForm.get('minimumAge').touched)">
                        <small class="form-text text-danger"
                               *ngIf="editForm.get('minimumAge').errors.min" jhiTranslate="entity.validation.min" [translateValues]="{ min: 0 }">
                            This field should be at least 0.
                        </small>
                        <small class="form-text text-danger"
                            [hidden]="!editForm.get('minimumAge')?.errors?.number" jhiTranslate="entity.validation.number">
                            This field should be a number.
                        </small>
                    </div>
                </div>
                <div class="form-group">
                    <label class="form-control-label" jhiTranslate="klinopsApp.clinicalStudy.maximumAge" for="field_maximumAge" [ngbTooltip]="'klinopsApp.clinicalStudy.help.maximumAge' | translate">Maximum Age</label>
                    <input type="number" class="form-control" name="maximumAge" id="field_maximumAge"
                           formControlName="maximumAge"/>
                    <div *ngIf="editForm.get('maximumAge').invalid && (editForm.get('maximumAge').dirty || editForm.get('maximumAge').touched)">
                        <small class="form-text text-danger"
                               *ngIf="editForm.get('maximumAge').errors.min" jhiTranslate="entity.validation.min" [translateValues]="{ min: 0 }">
                            This field should be at least 0.
                        </small>
                        <small class="form-text text-danger"
                            [hidden]="!editForm.get('maximumAge')?.errors?.number" jhiTranslate="entity.validation.number">
                            This field should be a number.
                        </small>
                    </div>
                </div>
                <div class="form-group">
                    <label class="form-control-label" jhiTranslate="klinopsApp.clinicalStudy.subjectsEnrolled" for="field_subjectsEnrolled" [ngbTooltip]="'klinopsApp.clinicalStudy.help.subjectsEnrolled' | translate">Subjects Enrolled</label>
                    <input type="number" class="form-control" name="subjectsEnrolled" id="field_subjectsEnrolled"
                           formControlName="subjectsEnrolled"/>
                    <div *ngIf="editForm.get('subjectsEnrolled').invalid && (editForm.get('subjectsEnrolled').dirty || editForm.get('subjectsEnrolled').touched)">
                        <small class="form-text text-danger"
                               *ngIf="editForm.get('subjectsEnrolled').errors.min" jhiTranslate="entity.validation.min" [translateValues]="{ min: 0 }">
                            This field should be at least 0.
                        </small>
                        <small class="form-text text-danger"
                            [hidden]="!editForm.get('subjectsEnrolled')?.errors?.number" jhiTranslate="entity.validation.number">
                            This field should be a number.
                        </small>
                    </div>
                </div>
                <div class="form-group">
                    <label class="form-control-label" jhiTranslate="klinopsApp.clinicalStudy.femalesEligible" for="field_femalesEligible" [ngbTooltip]="'klinopsApp.clinicalStudy.help.femalesEligible' | translate">Females Eligible</label>
                    <input type="checkbox" class="form-control" name="femalesEligible" id="field_femalesEligible"
                           formControlName="femalesEligible"/>
                </div>
                <div class="form-group">
                    <label class="form-control-label" jhiTranslate="klinopsApp.clinicalStudy.malesEligible" for="field_malesEligible" [ngbTooltip]="'klinopsApp.clinicalStudy.help.malesEligible' | translate">Males Eligible</label>
                    <input type="checkbox" class="form-control" name="malesEligible" id="field_malesEligible"
                           formControlName="malesEligible"/>
                </div>
                <div class="form-group">
                    <label class="form-control-label" jhiTranslate="klinopsApp.clinicalStudy.studyShortName" for="field_studyShortName" [ngbTooltip]="'klinopsApp.clinicalStudy.help.studyShortName' | translate">Study Short Name</label>
                    <input type="text" class="form-control" name="studyShortName" id="field_studyShortName"
                           formControlName="studyShortName"/>
                    <div *ngIf="editForm.get('studyShortName').invalid && (editForm.get('studyShortName').dirty || editForm.get('studyShortName').touched)">
                        <small class="form-text text-danger"
                               *ngIf="editForm.get('studyShortName').errors.required" jhiTranslate="entity.validation.required">
                        This field is required.
                        </small>
                        <small class="form-text text-danger"
                               *ngIf="editForm.get('studyShortName').errors.maxlength" jhiTranslate="entity.validation.maxlength" [translateValues]="{ max: 128 }">
                        This field cannot be longer than 128 characters.
                        </small>
                    </div>
                </div>
                <div class="form-group">
                    <label class="form-control-label" jhiTranslate="klinopsApp.clinicalStudy.projectManager" for="field_projectManager" [ngbTooltip]="'klinopsApp.clinicalStudy.help.projectManager' | translate">Project Manager</label>
                    <input type="text" class="form-control" name="projectManager" id="field_projectManager"
                           formControlName="projectManager"/>
                    <div *ngIf="editForm.get('projectManager').invalid && (editForm.get('projectManager').dirty || editForm.get('projectManager').touched)">
                        <small class="form-text text-danger"
                               *ngIf="editForm.get('projectManager').errors.required" jhiTranslate="entity.validation.required">
                        This field is required.
                        </small>
                    </div>
                </div>
                <div class="form-group">
                    <label class="form-control-label" jhiTranslate="klinopsApp.clinicalStudy.principalPhysician" for="field_principalPhysician" [ngbTooltip]="'klinopsApp.clinicalStudy.help.principalPhysician' | translate">Principal Physician</label>
                    <input type="text" class="form-control" name="principalPhysician" id="field_principalPhysician"
                           formControlName="principalPhysician"/>
                </div>
                <div class="form-group">
                    <label class="form-control-label" jhiTranslate="klinopsApp.clinicalStudy.researchRepresentative" for="field_researchRepresentative" [ngbTooltip]="'klinopsApp.clinicalStudy.help.researchRepresentative' | translate">Research Representative</label>
                    <input type="text" class="form-control" name="researchRepresentative" id="field_researchRepresentative"
                           formControlName="researchRepresentative"/>
                </div>
                <div class="form-group">
                    <label class="form-control-label" jhiTranslate="klinopsApp.clinicalStudy.analysisRepresentative" for="field_analysisRepresentative" [ngbTooltip]="'klinopsApp.clinicalStudy.help.analysisRepresentative' | translate">Analysis Representative</label>
                    <input type="text" class="form-control" name="analysisRepresentative" id="field_analysisRepresentative"
                           formControlName="analysisRepresentative"/>
                </div>
                <div class="form-group">
                    <label class="form-control-label" jhiTranslate="klinopsApp.clinicalStudy.dataManager" for="field_dataManager" [ngbTooltip]="'klinopsApp.clinicalStudy.help.dataManager' | translate">Data Manager</label>
                    <input type="text" class="form-control" name="dataManager" id="field_dataManager"
                           formControlName="dataManager"/>
                </div>

                <div class="form-group">
                    <label class="form-control-label" jhiTranslate="klinopsApp.clinicalStudy.masterFile" for="field_masterFile">Master File</label>
                    <select class="form-control" id="field_masterFile" name="masterFile" formControlName="masterFile">
                        <option [ngValue]="null"></option>
                        <option [ngValue]="trialMasterFileOption.id === editForm.get('masterFile').value?.id ? editForm.get('masterFile').value : trialMasterFileOption" *ngFor="let trialMasterFileOption of masterfiles; trackBy: trackTrialMasterFileById">{{trialMasterFileOption.name}}</option>
                    </select>
                </div>
                <div class="form-group">
                    <label jhiTranslate="klinopsApp.clinicalStudy.investigators" for="field_investigators">Investigators</label>
                    <select class="form-control" id="field_investigators" multiple name="investigators" formControlName="investigators">
                        <option [ngValue]="getSelected(editForm.get('investigators').value, principalInvestigatorOption)" *ngFor="let principalInvestigatorOption of principalinvestigators; trackBy: trackPrincipalInvestigatorById">{{principalInvestigatorOption.investigatorName}}</option>
                    </select>
                </div>
            </div>
            <div>
                <button type="button" id="cancel-save" class="btn btn-secondary"  (click)="previousState()">
                    <fa-icon [icon]="'ban'"></fa-icon>&nbsp;<span jhiTranslate="entity.action.cancel">Cancel</span>
                </button>
                <button type="submit" id="save-entity" [disabled]="editForm.invalid || isSaving" class="btn btn-primary">
                    <fa-icon [icon]="'save'"></fa-icon>&nbsp;<span jhiTranslate="entity.action.save">Save</span>
                </button>
            </div>
        </form>
    </div>
</div>
